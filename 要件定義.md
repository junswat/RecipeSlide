レシピスライド管理PWA - 要件定義書
プロジェクト概要
目的: PerplexityでYouTubeレシピ動画を要約したMarkdownファイルを、スライド形式で閲覧・管理できるAndroid向けPWAを構築する
ターゲットユーザー: 料理中にレシピを確認したい主婦・主夫
開発環境: PWA（HTML/CSS/JavaScript）

技術スタック
必須技術

フロントエンド: HTML5, CSS3, Vanilla JavaScript（またはReact/Vue.jsも可）
Markdown解析: markdown-it または marked.js
スライダー: Swiper.js
ローカルストレージ: IndexedDB（Dexie.jsライブラリ推奨）
PWA機能: Service Worker, Web App Manifest

推奨ライブラリ

UI: Tailwind CSS または Bootstrap 5
アイコン: Material Icons または Font Awesome
状態管理: 必要に応じてZustand またはシンプルなContext API


機能要件
1. レシピ登録機能
必須機能:

Markdownテキストの入力フォーム（textarea）
料理名の自動抽出（mdファイル内の最初の# 料理名を取得）
レシピの新規作成・保存
サムネイル画像のアップロード（任意、base64エンコードして保存）

入力バリデーション:

Markdownテキストが空でないこと
同名のレシピが既に存在する場合は警告

データ保存:

IndexedDBに保存
保存時に自動的にタイムスタンプを付与


2. スライド表示機能
スライド生成ロジック:

Markdownを見出し（#, ##, ###）で分割してスライド化
***（水平線）もスライド区切りとして認識
各スライドにMarkdownをHTMLに変換して表示

スライド操作:

左右スワイプでスライド移動
左右の矢印ボタンでもスライド移動可能
ページインジケーター表示（例: 3/12）
最初のスライドで左スワイプ→何もしない
最後のスライドで右スワイプ→何もしない

表示設定:

フォントサイズ調整ボタン（小/中/大/特大の4段階）
画面の自動オフ防止（Wake Lock API使用）
フルスクリーンモード切替ボタン

その他:

戻るボタン（ボード一覧に戻る）
現在のスライド位置を保存（次回開いた時に前回の位置から再開）


3. ボード管理機能（レシピ一覧）
表示形式:

カード形式のグリッドレイアウト
各カードに表示する情報：

サムネイル画像（なければデフォルト画像）
料理名
カテゴリラベル
お気に入りアイコン
作成日



ソート・フィルター:

カテゴリでフィルター（和食/洋食/中華/その他）
お気に入りのみ表示
作成日順/料理名順でソート
検索ボックス（料理名で部分一致検索）

カード操作:

タップでスライド表示画面へ遷移
長押しでコンテキストメニュー表示（編集/削除/共有）


4. レシピ編集・削除機能
編集:

登録済みのMarkdownテキストを編集可能
カテゴリ、お気に入り状態の変更
サムネイル画像の差し替え

削除:

削除確認ダイアログを表示
削除実行後はボード一覧に戻る


5. 便利機能
タイマー機能:

スライド表示画面にタイマーボタン配置
クイック設定（1分/3分/5分/10分/カスタム）
バックグラウンドでもカウント継続
タイマー終了時に通知（Notification API）

買い物リスト生成:

Markdown内の「材料」セクションを自動抽出
チェックボックス付きリスト形式で表示
チェック状態をローカルストレージに保存
リストのコピー機能（クリップボードにコピー）

レシピ共有:

Markdownテキストを他のアプリに共有（Web Share API）
または専用のエクスポート機能（JSON形式でダウンロード）


データ構造
IndexedDBスキーマ
javascript// レシピテーブル
{
  id: string,              // UUID
  title: string,           // 料理名
  category: string,        // 'japanese' | 'western' | 'chinese' | 'other'
  favorite: boolean,       // お気に入りフラグ
  thumbnail: string,       // base64画像データまたはURL（任意）
  markdownText: string,    // 元のMarkdownテキスト全文
  slides: [                // スライドデータ配列
    {
      heading: string,     // 見出しテキスト
      content: string,     // HTML変換済みコンテンツ
      level: number        // 見出しレベル（1-3）
    }
  ],
  ingredients: string[],   // 材料リスト（買い物リスト用）
  currentSlideIndex: number, // 前回閲覧していたスライド位置
  createdAt: timestamp,    // 作成日時
  updatedAt: timestamp     // 更新日時
}
LocalStorageで管理するデータ
javascript{
  fontSize: string,        // 'small' | 'medium' | 'large' | 'xlarge'
  defaultCategory: string, // デフォルトカテゴリ
  sortOrder: string,       // 'date' | 'name'
  wakeLockEnabled: boolean // 画面オフ防止の有効/無効
}
```

---

## UI/UX要件

### デザイン指針
- **シンプル**: 余計な装飾を排除し、視認性を最優先
- **大きなタップ領域**: 料理中でも操作しやすい大きなボタン
- **コントラスト**: 遠くからでも読みやすい配色
- **レスポンシブ**: スマホの縦持ち・横持ち両対応

### カラースキーム（推奨）
- プライマリカラー: オレンジ系（料理のイメージ）
- 背景: ホワイト
- テキスト: ダークグレー
- アクセント: グリーン（お気に入りなど）

### フォント
- 本文: Noto Sans JP または Roboto（読みやすいゴシック体）
- 見出し: 太めのウェイト

---

## 画面遷移図
```
[ボード一覧画面]
  ├─ [+ 新規登録] → [レシピ登録画面] → 保存 → [ボード一覧画面]
  ├─ [カードタップ] → [スライド表示画面]
  │                      ├─ [戻る] → [ボード一覧画面]
  │                      ├─ [タイマー] → [タイマーモーダル]
  │                      └─ [買い物リスト] → [買い物リストモーダル]
  └─ [長押し] → [コンテキストメニュー]
                  ├─ [編集] → [レシピ編集画面]
                  ├─ [削除] → 確認ダイアログ → [ボード一覧画面]
                  └─ [共有] → Web Share API

PWA要件
Service Worker

オフラインでの動作保証
アプリシェルのキャッシュ
画像などの静的リソースをキャッシュ

Web App Manifest
json{
  "name": "レシピスライド",
  "short_name": "レシピ",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#ff6b35",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

### ホーム画面追加の促進
- 初回訪問時にインストールバナーを表示
- 設定画面にインストール手順を記載

---

## 実装の優先順位

### Phase 1（MVP: Minimum Viable Product）
1. レシピ登録機能（基本的な入力フォーム）
2. スライド表示機能（スワイプ、ページ送り）
3. ボード一覧表示（シンプルなリスト形式）
4. IndexedDBへの保存・読み込み

### Phase 2（使いやすさ向上）
5. カテゴリ分類とフィルター
6. お気に入り機能
7. 検索機能
8. フォントサイズ調整
9. 画面オフ防止

### Phase 3（便利機能追加）
10. タイマー機能
11. 買い物リスト生成
12. レシピ共有機能
13. サムネイル画像登録
14. レシピ編集・削除

### Phase 4（PWA最適化）
15. Service Worker実装
16. Web App Manifest設定
17. オフライン対応
18. ホーム画面追加促進

---

## テストケース

### 基本動作確認
- [ ] Markdownテキストが正しくスライドに分割される
- [ ] スライドのスワイプ操作が滑らか
- [ ] IndexedDBへの保存・読み込みが正常
- [ ] PWAとしてホーム画面に追加できる

### エッジケース
- [ ] 見出しのないMarkdownテキストの処理
- [ ] 非常に長いレシピ（100スライド以上）の動作
- [ ] ネットワーク切断時の動作
- [ ] ストレージ容量上限到達時の処理

---

## 参考資料

**提供するサンプルMarkdown:**
- ハンバーグのレシピ（上記のmdファイル）

**想定される入力パターン:**
- 見出しレベル1: 料理名、材料、作り方など大項目
- 見出しレベル2: 作り方の各ステップ
- 見出しレベル3: 細かい注意点
- 水平線（`***`）: セクション区切り

---

## 成果物

以下のファイル構成で納品してください:
```
/
├── index.html
├── manifest.json
├── service-worker.js
├── css/
│   └── style.css
├── js/
│   ├── app.js
│   ├── db.js (IndexedDB操作)
│   ├── markdown-parser.js
│   └── slider.js
├── images/
│   ├── icon-192.png
│   └── icon-512.png
└── README.md (セットアップ手順)